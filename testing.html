<!DOCTYPE html>
<html lang="en">

<head>
    <title>Model & DB</title>
</head>

<body class="bg-light text-dark">
    <!-- Navbar -->
    <div id="navbar-container"></div>

    <div class="container py-4">
        <h1 class="text-center mb-2"><i class="fas fa-book-open text-primary me-2"></i> Laravel Eloquent & DB Essentials
        </h1>

        <div class="text-center mb-4">
            <a href="model-db-qa.html" class="btn btn-primary btn-lg">
                <i class="fas fa-question-circle me-2"></i> Questions & Answers
            </a>
        </div>

        <!-- Search -->
        <input type="search" id="search" class="form-control mb-4 search-input"
            placeholder="Search topics or keywords..." aria-label="Search">

        <div class="accordion" id="qaAccordion"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/script.js"></script>

    <script>
        fetch("data/routes.json")
            .then(res => res.json())
            .then(data => {
                const accordion = document.getElementById("qaAccordion");

                data.forEach((topic, index) => {
                    const topicId = `collapse${index}`;

                    let sectionsHtml = topic.sections.map(section => {
                        let content = "";

                        if (section.type === "table") {
                            const headers = section.headers.map(h => `<th>${h}</th>`).join("");
                            const rows = section.rows.map(
                                row => `<tr>${row.map(cell => `<td><code>${cell}</code></td>`).join("")}</tr>`
                            ).join("");
                            content = `<h6>${section.heading}</h6>
                                        <table class="table table-bordered">
                                            <thead><tr>${headers}</tr></thead>
                                            <tbody>${rows}</tbody>
                                        </table>`;
                        } else if (section.type === "list") {
                            const items = section.items.map(item => {
                                const formatted = item.replace(/`(.*?)`/g, '<code>$1</code>');
                                return `<li>${formatted}</li>`;
                            }).join("");

                            content = `<h6>${section.heading}</h6><ul>${items}</ul>`;
                            if (section.code) {
                                content += `<pre><code>${section.code}</code></pre>`;
                            }
                        } else {
                            let items = "";
                            if (section.items) {
                                items = section.items.map(item => {
                                    const formatted = item.replace(/`(.*?)`/g, '<code>$1</code>');
                                    return `<p>${formatted}</p>`;
                                }).join("");
                            }

                            content = `<h6>${section.heading}</h6>${items}`;
                            if (section.code) {
                                content += `<pre><code>${section.code}</code></pre>`;
                            }
                        }

                        return content;
                    }).join("");

                    accordion.insertAdjacentHTML("beforeend", `
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading${index}">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
              data-bs-target="#${topicId}">
              <strong>0${index + 1}</strong>&nbsp; ${topic.title}
            </button>
          </h2>
          <div id="${topicId}" class="accordion-collapse collapse" data-bs-parent="#qaAccordion">
            <div class="accordion-body">
              ${sectionsHtml}
            </div>
          </div>
        </div>
      `);
                });
            })
            .catch(err => console.error("Failed to load QA:", err));
    </script>
</body>

</html>